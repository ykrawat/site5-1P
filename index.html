<!DOCTYPE html>
<html>
<head>
    <title>Fixed Pixel Test</title>
    <!-- jQuery Library -->
    <script src="https://code.jquery.com/jquery-3.6.0.min.js"></script>
    
   <!-- Signals Gateway Pixel + Meta Pixel Code -->
    <script>
      !(function(f,b,e,v,vv,n,nn,t,s,tt,ss){
        if (!f.cbq){nn = f.cbq = function(){nn.initialized ? nn.apply(f.cbq, arguments) : nn.queue.push(arguments);};
        if(!f._cbq) f._cbq = nn;
        nn.push = nn; nn.loaded = !0; nn.version = '2.0'; nn.queue = [];
        tt = b.createElement(e); tt.async = !0; tt.src = vv; ss=b.getElementsByTagName(e)[0]; ss.parentNode.insertBefore(tt,ss);}
        if (f.xbq) return; if (f.fbq) f.xbq=f.fbq;
        n = f.fbq = function()
       {if((arguments[0]==='track'||arguments[0]==='trackCustom')&&arguments.length<3)arguments=[...arguments,{},{eventID:arguments[1]+"."+Date.now().toString()+Math.random().toString(36)}];
          else if((arguments[0]==='track'||arguments[0]==='trackCustom')&&arguments.length<4)arguments=[...arguments,{eventID:arguments[1]+"."+Date.now().toString()+Math.random().toString(36)}];
          else if((arguments[0]==='trackSingle'||arguments[0]==='trackSingleCustom')&&arguments.length<4)arguments=[...arguments,{},{eventID:arguments[2]+"."+Date.now().toString()+Math.random().toString(36)}];
          else if((arguments[0]==='trackSingle'||arguments[0]==='trackSingleCustom')&&arguments.length<5)arguments=[...arguments,{eventID:arguments[2]+"."+Date.now().toString()+Math.random().toString(36)}];
        if(arguments[0]==='track'){if(!arguments[3] || !arguments[3].eventID) arguments[3]={...arguments[3],eventID:arguments[1]+"."+Date.now().toString()+"."+Math.random().toString(36)}};
        if(arguments[0].startsWith('trackSingle')){if(!arguments[4]||!arguments[4].eventID) arguments[4]={...arguments[4],eventID:arguments[2]+"."+Date.now().toString()+"."+Math.random().toString(36)}};
        n.callMethod ? n.callMethod.apply(n, arguments) : n.queue.push(arguments);
        if (arguments[0].startsWith('track')) {
          if(arguments[0].startsWith('trackSingle')) arguments[1]='3510123408241937578';
          f.cbq.initialized ? f.cbq.apply(f.cbq, arguments) : f.cbq.queue.push(arguments);}
        }
       if(!f._fbq) f._fbq = n;
        n.push = n; n.loaded = !0; n.version = '2.0'; n.queue = (f.xbq)?f.xbq.queue:[];
        t = b.createElement(e); t.async = !0; t.src = v;s=b.getElementsByTagName(e)[0]; s.parentNode.insertBefore(t,s);
      })
      (window, document, 'script', 'https://connect.facebook.net/en_US/fbevents.js', 'https://web.capig-19df7701-e2e-agency.cbinternal.org/sdk/3510123408241937578/events.js');
      fbq('init', '45202414779652');fbq('track', 'PageView');
      cbq('setHost', 'https://capig-19df7701-e2e-agency.cbinternal.org/');
    cbq('init', '3510123408241937578');
      cbq('set', 'integrationMethod', 'forkFromSnippetCode');
    </script>
  <!-- End Signals Gateway Pixel + Meta Pixel Code -->
</head>
<body>
    <h1>Pixel Event Test Page</h1>
    <p>The following are Meta button tests:</p>
    
    <button id="addToCartButton">Add to cart</button>
    <button id="addToCartButtonCustom">Add to cart Custom</button>
    <button id="addToCartButtonSingle">Add to cart Single</button>
    <button id="addToCartButtonSingleCustom">Add to cart Single Custom</button>

    <!-- Event handlers at bottom of body -->
    <script type="text/javascript">
      $(document).ready(function() {
        console.log('jQuery loaded and DOM ready');
        
        $('#addToCartButton').click(function() {
          console.log('AddToCart button clicked');
          try {
            fbq('track', 'AddToCart');
            fbq('track', 'AddToCart', {currency: "USD", value: 20.00});
            fbq('track', 'AddToCart', {currency: "USD", value: 20.10}, {eventID:"track.0930"});
            console.log('AddToCart events sent');
          } catch(e) {
            console.error('Error sending AddToCart events:', e);
          }
        });

        $('#addToCartButtonCustom').click(function() {
          console.log('AddToCartCustom button clicked');
          try {
            fbq('trackCustom', 'AddToCartCustom');
            fbq('trackCustom', 'AddToCartCustom', {currency: "USD", value: 21.00});
            fbq('trackCustom', 'AddToCartCustom', {currency: "USD", value: 21.10}, {eventID:"trackCustom.0930"});
            console.log('AddToCartCustom events sent');
          } catch(e) {
            console.error('Error sending AddToCartCustom events:', e);
          }
        });

        $('#addToCartButtonSingle').click(function() {
          console.log('AddToCartSingle button clicked');
          try {
            fbq('trackSingle', '45202414779652', 'AddToCartSingle');
            fbq('trackSingle', '45202414779652', 'AddToCartSingle', {currency: "USD", value: 22.00});
            fbq('trackSingle', '45202414779652', 'AddToCartSingle', {currency: "USD", value: 22.10}, {eventID:"trackSingle.0930"});
            console.log('AddToCartSingle events sent');
          } catch(e) {
            console.error('Error sending AddToCartSingle events:', e);
          }
        });

        $('#addToCartButtonSingleCustom').click(function() {
          console.log('AddToCartSingleCustom button clicked');
          try {
            fbq('trackSingleCustom', '45202414779652', 'AddToCartSingleCustom');
            fbq('trackSingleCustom', '45202414779652', 'AddToCartSingleCustom', {currency: "USD", value: 23.00});
            fbq('trackSingleCustom', '45202414779652', 'AddToCartSingleCustom', {currency: "USD", value: 23.10}, {eventID:"AddToCartSingleCustom.0930"});
            console.log('AddToCartSingleCustom events sent');
          } catch(e) {
            console.error('Error sending AddToCartSingleCustom events:', e);
          }
        });
      });
    </script>

    <!-- Debug Script -->
    <script>
      // Debug function to check pixel status
      function checkPixelStatus() {
        console.log('Meta Pixel (fbq) available:', typeof fbq !== 'undefined');
        console.log('Cloudbridge Pixel (cbq) available:', typeof cbq !== 'undefined');
        console.log('jQuery available:', typeof $ !== 'undefined');
        
        // Check if pixels are initialized
        if (typeof fbq !== 'undefined') {
          console.log('fbq queue length:', fbq.queue ? fbq.queue.length : 'N/A');
        }
        if (typeof cbq !== 'undefined') {
          console.log('cbq queue length:', cbq.queue ? cbq.queue.length : 'N/A');
        }
      }
      
      // Run debug check after page loads
      setTimeout(checkPixelStatus, 2000);
    </script>
</body>
</html>



